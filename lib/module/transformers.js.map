{"version":3,"sources":["transformers.js"],"names":["_size","_reduce","_reverse","_keys","_values","_pick","_pickBy","_nth","_omit","_omitBy","_groupBy","_sortBy","_filter","_map","_mapValues","_findIndex","_findKey","_isEqual","remap","isPlainObject","get","_get","template","config","getChildContext","ops","validators","test","transform","MSG","messages","UNARY","BINARY","OP_MATCH","MATCH","OP_SIZE","SIZE","OP_SUM","SUM","OP_GET_TYPE","GET_TYPE","OP_GET_BY_INDEX","GET_BY_INDEX","OP_GET_BY_KEY","GET_BY_KEY","OP_FIND","FIND","OP_IF","IF","OP_CAST_ARRAY","CAST_ARRAY","OP_ADD","ADD","OP_SUB","SUB","OP_MUL","MUL","OP_DIV","DIV","OP_MOD","MOD","OP_KEYS","KEYS","OP_VALUES","VALUES","OP_ENTRIES","ENTRIES","OP_OBJ_TO_ARRAY","OBJ_TO_ARRAY","OP_PICK","PICK","OP_OMIT","OMIT","OP_SLICE","SLICE","OP_GROUP","GROUP","OP_SORT","SORT","OP_REVERSE","REVERSE","OP_JOIN","JOIN","OP_MERGE","MERGE","OP_FILTER","FILTER","OP_REMAP","REMAP","OP_TO_JSON","TO_JSON","OP_TO_OBJ","TO_OBJ","OP_SET","SET","OP_ADD_ITEM","ADD_ITEM","OP_ASSIGN","ASSIGN","OP_APPLY","APPLY","OP_INTERPOLATE","INTERPOLATE","matchOptions","throwError","abortEarly","asPredicate","addTransformerToMap","left","right","context","sum","item","Array","isArray","Number","isInteger","targetValue","console","log","predicate","value","Error","OPERAND_NOT_ARRAY","length","OPERAND_NOT_TUPLE_2_OR_3","condition","key","v","k","VALUE_NOT_ARRAY","slice","INVALID_OP_EXPR","join","toString","objectMerger","result","expr","Object","assign","arrayMerger","reduce","VALUE_NOT_COLLECTION","path","makePath","OPERAND_NOT_TUPLE","OPERAND_NOT_OBJECT","JSON","stringify","parse","undefined","concat","VALUE_NOT_OBJECT","rightValue","VALUE_NOT_STRING"],"mappings":"AAAA;AACA,OAAOA,KAAP,MAAkB,aAAlB;AACA,OAAOC,OAAP,MAAoB,eAApB;AACA,OAAOC,QAAP,MAAqB,gBAArB;AACA,OAAOC,KAAP,MAAkB,aAAlB;AACA,OAAOC,OAAP,MAAoB,eAApB;AACA,OAAOC,KAAP,MAAkB,aAAlB;AACA,OAAOC,OAAP,MAAoB,eAApB;AACA,OAAOC,IAAP,MAAiB,YAAjB;AACA,OAAOC,KAAP,MAAkB,aAAlB;AACA,OAAOC,OAAP,MAAoB,eAApB;AACA,OAAOC,QAAP,MAAqB,gBAArB;AACA,OAAOC,OAAP,MAAoB,eAApB;AACA,OAAOC,OAAP,MAAoB,eAApB;AACA,OAAOC,IAAP,MAAiB,YAAjB;AACA,OAAOC,UAAP,MAAuB,kBAAvB;AACA,OAAOC,UAAP,MAAuB,kBAAvB;AACA,OAAOC,QAAP,MAAqB,gBAArB;AACA,OAAOC,QAAP,MAAqB,gBAArB;AAEA,SAASC,KAAT,EAAgBC,aAAhB,EAA+BC,GAAG,IAAIC,IAAtC,EAA4CC,QAA5C,QAA4D,YAA5D;AAEA,OAAOC,MAAP,IAAiBC,eAAjB,QAAwC,UAAxC;AACA,OAAOC,GAAP,MAAgB,wBAAhB;AACA,OAAOC,UAAP,MAAuB,qBAAvB;AACA,SAASC,IAAT,QAAqB,YAArB;AACA,OAAO,cAAP;AACA,OAAOC,SAAP,MAAsB,aAAtB;AAEA,MAAMC,GAAG,GAAGN,MAAM,CAACO,QAAnB;AAEA,MAAMC,KAAK,GAAG,IAAd;AACA,MAAMC,MAAM,GAAG,KAAf,C,CAEA;;AACA,MAAMC,QAAQ,GAAG,CAACR,GAAG,CAACS,KAAL,EAAYF,MAAZ,EAAoB,MAApB,EAA4B,QAA5B,EAAsC,MAAtC,EAA8C,WAA9C,EAA2D,OAA3D,CAAjB;AACA,MAAMG,OAAO,GAAG,CAACV,GAAG,CAACW,IAAL,EAAWL,KAAX,EAAkB,OAAlB,EAA2B,SAA3B,EAAsC,QAAtC,CAAhB;AACA,MAAMM,MAAM,GAAG,CAACZ,GAAG,CAACa,GAAL,EAAUP,KAAV,EAAiB,MAAjB,EAAyB,QAAzB,CAAf;AACA,MAAMQ,WAAW,GAAG,CAACd,GAAG,CAACe,QAAL,EAAeT,KAAf,EAAsB,OAAtB,CAApB;AACA,MAAMU,eAAe,GAAG,CAAChB,GAAG,CAACiB,YAAL,EAAmBV,MAAnB,EAA2B,KAA3B,EAAkC,aAAlC,EAAiD,MAAjD,CAAxB,C,CAAkF;;AAClF,MAAMW,aAAa,GAAG,CAAClB,GAAG,CAACmB,UAAL,EAAiBZ,MAAjB,EAAyB,KAAzB,EAAgC,UAAhC,EAA4C,WAA5C,CAAtB,C,CAAgF;;AAChF,MAAMa,OAAO,GAAG,CAACpB,GAAG,CAACqB,IAAL,EAAWd,MAAX,EAAmB,UAAnB,EAA+B,QAA/B,CAAhB;AACA,MAAMe,KAAK,GAAG,CAACtB,GAAG,CAACuB,EAAL,EAAShB,MAAT,EAAiB,KAAjB,CAAd;AACA,MAAMiB,aAAa,GAAG,CAACxB,GAAG,CAACyB,UAAL,EAAiBnB,KAAjB,EAAwB,YAAxB,EAAsC,YAAtC,CAAtB,C,CAEA;;AACA,MAAMoB,MAAM,GAAG,CAAC1B,GAAG,CAAC2B,GAAL,EAAUpB,MAAV,EAAkB,MAAlB,EAA0B,OAA1B,EAAmC,MAAnC,CAAf;AACA,MAAMqB,MAAM,GAAG,CAAC5B,GAAG,CAAC6B,GAAL,EAAUtB,MAAV,EAAkB,MAAlB,EAA0B,WAA1B,EAAuC,QAAvC,EAAiD,MAAjD,CAAf;AACA,MAAMuB,MAAM,GAAG,CAAC9B,GAAG,CAAC+B,GAAL,EAAUxB,MAAV,EAAkB,MAAlB,EAA0B,WAA1B,EAAuC,QAAvC,CAAf;AACA,MAAMyB,MAAM,GAAG,CAAChC,GAAG,CAACiC,GAAL,EAAU1B,MAAV,EAAkB,MAAlB,EAA0B,SAA1B,CAAf;AACA,MAAM2B,MAAM,GAAG,CAAClC,GAAG,CAACmC,GAAL,EAAU5B,MAAV,EAAkB,MAAlB,EAA0B,YAA1B,CAAf,C,CAEA;;AACA,MAAM6B,OAAO,GAAG,CAACpC,GAAG,CAACqC,IAAL,EAAW/B,KAAX,EAAkB,OAAlB,CAAhB;AACA,MAAMgC,SAAS,GAAG,CAACtC,GAAG,CAACuC,MAAL,EAAajC,KAAb,EAAoB,SAApB,CAAlB;AACA,MAAMkC,UAAU,GAAG,CAACxC,GAAG,CAACyC,OAAL,EAAcnC,KAAd,EAAqB,UAArB,CAAnB;AACA,MAAMoC,eAAe,GAAG,CAAC1C,GAAG,CAAC2C,YAAL,EAAmBrC,KAAnB,EAA0B,UAA1B,EAAsC,gBAAtC,CAAxB;AACA,MAAMsC,OAAO,GAAG,CAAC5C,GAAG,CAAC6C,IAAL,EAAWtC,MAAX,EAAmB,OAAnB,EAA4B,SAA5B,EAAuC,eAAvC,CAAhB,C,CAAyE;;AACzE,MAAMuC,OAAO,GAAG,CAAC9C,GAAG,CAAC+C,IAAL,EAAWxC,MAAX,EAAmB,OAAnB,EAA4B,SAA5B,CAAhB;AACA,MAAMyC,QAAQ,GAAG,CAAChD,GAAG,CAACiD,KAAL,EAAY1C,MAAZ,EAAoB,QAApB,EAA8B,QAA9B,CAAjB;AACA,MAAM2C,QAAQ,GAAG,CAAClD,GAAG,CAACmD,KAAL,EAAY5C,MAAZ,EAAoB,QAApB,EAA8B,UAA9B,CAAjB;AACA,MAAM6C,OAAO,GAAG,CAACpD,GAAG,CAACqD,IAAL,EAAW9C,MAAX,EAAmB,OAAnB,EAA4B,UAA5B,EAAwC,SAAxC,CAAhB;AACA,MAAM+C,UAAU,GAAG,CAACtD,GAAG,CAACuD,OAAL,EAAcjD,KAAd,EAAqB,UAArB,CAAnB;AACA,MAAMkD,OAAO,GAAG,CAACxD,GAAG,CAACyD,IAAL,EAAWlD,MAAX,EAAmB,OAAnB,CAAhB;AACA,MAAMmD,QAAQ,GAAG,CAAC1D,GAAG,CAAC2D,KAAL,EAAYpD,MAAZ,EAAoB,QAApB,CAAjB,C,CAAgD;;AAChD,MAAMqD,SAAS,GAAG,CAAC5D,GAAG,CAAC6D,MAAL,EAAatD,MAAb,EAAqB,SAArB,EAAgC,SAAhC,EAA2C,gBAA3C,CAAlB,C,CAAgF;;AAChF,MAAMuD,QAAQ,GAAG,CAAC9D,GAAG,CAAC+D,KAAL,EAAYxD,MAAZ,EAAoB,QAApB,EAA8B,UAA9B,CAAjB,C,CAA4D;;AAC5D,MAAMyD,UAAU,GAAG,CAAChE,GAAG,CAACiE,OAAL,EAAc3D,KAAd,EAAqB,OAArB,EAA8B,SAA9B,EAAyC,YAAzC,CAAnB;AACA,MAAM4D,SAAS,GAAG,CAAClE,GAAG,CAACmE,MAAL,EAAa7D,KAAb,EAAoB,SAApB,EAA+B,WAA/B,EAA4C,YAA5C,CAAlB,C,CAEA;;AACA,MAAM8D,MAAM,GAAG,CAACpE,GAAG,CAACqE,GAAL,EAAU9D,MAAV,EAAkB,MAAlB,EAA0B,IAA1B,EAAgC,QAAhC,CAAf;AACA,MAAM+D,WAAW,GAAG,CAACtE,GAAG,CAACuE,QAAL,EAAehE,MAAf,EAAuB,UAAvB,EAAmC,YAAnC,CAApB;AACA,MAAMiE,SAAS,GAAG,CAACxE,GAAG,CAACyE,MAAL,EAAalE,MAAb,EAAqB,SAArB,EAAgC,WAAhC,CAAlB;AACA,MAAMmE,QAAQ,GAAG,CAAC1E,GAAG,CAAC2E,KAAL,EAAYpE,MAAZ,EAAoB,QAApB,EAA8B,OAA9B,CAAjB,C,CAAyD;AAEzD;;AACA,MAAMqE,cAAc,GAAG,CAAC5E,GAAG,CAAC6E,WAAL,EAAkBtE,MAAlB,EAA0B,cAA1B,EAA0C,WAA1C,CAAvB,C,CAEA;AACA;;AACA,MAAMuE,YAAY,GAAG;AAAEC,EAAAA,UAAU,EAAE,KAAd;AAAqBC,EAAAA,UAAU,EAAE,IAAjC;AAAuCC,EAAAA,WAAW,EAAE;AAApD,CAArB;AAEAnF,MAAM,CAACoF,mBAAP,CAA2B1E,QAA3B,EAAqC,CAAC2E,IAAD,EAAOC,KAAP,EAAcC,OAAd,KACjCnF,IAAI,CAACiF,IAAD,EAAOlF,UAAU,CAACQ,KAAlB,EAAyB2E,KAAzB,EAAgCN,YAAhC,EAA8CO,OAA9C,CADR;AAIAvF,MAAM,CAACoF,mBAAP,CAA2BxE,OAA3B,EAAqCyE,IAAD,IAAU5G,KAAK,CAAC4G,IAAD,CAAnD;AAEArF,MAAM,CAACoF,mBAAP,CAA2BtE,MAA3B,EAAoCuE,IAAD,IAC/B3G,OAAO,CACH2G,IADG,EAEH,CAACG,GAAD,EAAMC,IAAN,KAAe;AACXD,EAAAA,GAAG,IAAIC,IAAP;AACA,SAAOD,GAAP;AACH,CALE,EAMH,CANG,CADX;AAWAxF,MAAM,CAACoF,mBAAP,CAA2BpE,WAA3B,EAAyCqE,IAAD,IACpCK,KAAK,CAACC,OAAN,CAAcN,IAAd,IAAsB,OAAtB,GAAgCO,MAAM,CAACC,SAAP,CAAiBR,IAAjB,IAAyB,SAAzB,GAAqC,OAAOA,IADhF;AAIArF,MAAM,CAACoF,mBAAP,CAA2BlE,eAA3B,EAA4C,CAACmE,IAAD,EAAOC,KAAP,KAAiBtG,IAAI,CAACqG,IAAD,EAAOC,KAAP,CAAjE;AACAtF,MAAM,CAACoF,mBAAP,CAA2BhE,aAA3B,EAA0C,CAACiE,IAAD,EAAOC,KAAP,KAAiBxF,IAAI,CAACuF,IAAD,EAAOC,KAAP,CAA/D;AAEAtF,MAAM,CAACoF,mBAAP,CAA2B9D,OAA3B,EAAoC,CAAC+D,IAAD,EAAOC,KAAP,EAAcC,OAAd,KAA0B;AAC1D,QAAMO,WAAW,GAAGzF,SAAS,CAAC,IAAD,EAAOiF,KAAP,EAAcC,OAAd,CAA7B;AACAQ,EAAAA,OAAO,CAACC,GAAR,CAAYX,IAAZ,EAAkBS,WAAlB,EAA+BP,OAA/B;;AACA,QAAMU,SAAS,GAAIC,KAAD,IAAWxG,QAAQ,CAACwG,KAAD,EAAQJ,WAAR,CAArC;;AACA,SAAOJ,KAAK,CAACC,OAAN,CAAcN,IAAd,IAAsB7F,UAAU,CAAC6F,IAAD,EAAOY,SAAP,CAAhC,GAAoDxG,QAAQ,CAAC4F,IAAD,EAAOY,SAAP,CAAnE;AACH,CALD;AAOAjG,MAAM,CAACoF,mBAAP,CAA2B5D,KAA3B,EAAkC,CAAC6D,IAAD,EAAOC,KAAP,EAAcC,OAAd,KAA0B;AACxD,MAAI,CAACG,KAAK,CAACC,OAAN,CAAcL,KAAd,CAAL,EAA2B;AACvB,UAAM,IAAIa,KAAJ,CAAU7F,GAAG,CAAC8F,iBAAJ,CAAsBlG,GAAG,CAACuB,EAA1B,CAAV,CAAN;AACH;;AAED,MAAI6D,KAAK,CAACe,MAAN,GAAe,CAAf,IAAoBf,KAAK,CAACe,MAAN,GAAe,CAAvC,EAA0C;AACtC,UAAM,IAAIF,KAAJ,CAAU7F,GAAG,CAACgG,wBAAJ,CAA6BpG,GAAG,CAACuB,EAAjC,CAAV,CAAN;AACH;;AAED,QAAM8E,SAAS,GAAGlG,SAAS,CAACgF,IAAD,EAAOC,KAAK,CAAC,CAAD,CAAZ,EAAiBC,OAAjB,CAA3B;;AAEA,MAAIgB,SAAJ,EAAe;AACX,WAAOlG,SAAS,CAACgF,IAAD,EAAOC,KAAK,CAAC,CAAD,CAAZ,EAAiBC,OAAjB,CAAhB;AACH,GAFD,MAEO,IAAID,KAAK,CAACe,MAAN,GAAe,CAAnB,EAAsB;AACzB,WAAOhG,SAAS,CAACgF,IAAD,EAAOC,KAAK,CAAC,CAAD,CAAZ,EAAiBC,OAAjB,CAAhB;AACH;;AAED,SAAOF,IAAP;AACH,CAlBD;AAoBArF,MAAM,CAACoF,mBAAP,CAA2B1D,aAA3B,EAA2C2D,IAAD,IAAWA,IAAI,IAAI,IAAR,GAAe,IAAf,GAAsBK,KAAK,CAACC,OAAN,CAAcN,IAAd,IAAsBA,IAAtB,GAA6B,CAACA,IAAD,CAAxG;AAEArF,MAAM,CAACoF,mBAAP,CAA2BxD,MAA3B,EAAmC,CAACyD,IAAD,EAAOC,KAAP,KAAiBD,IAAI,GAAGC,KAA3D;AACAtF,MAAM,CAACoF,mBAAP,CAA2BtD,MAA3B,EAAmC,CAACuD,IAAD,EAAOC,KAAP,KAAiBD,IAAI,GAAGC,KAA3D;AACAtF,MAAM,CAACoF,mBAAP,CAA2BpD,MAA3B,EAAmC,CAACqD,IAAD,EAAOC,KAAP,KAAiBD,IAAI,GAAGC,KAA3D;AACAtF,MAAM,CAACoF,mBAAP,CAA2BlD,MAA3B,EAAmC,CAACmD,IAAD,EAAOC,KAAP,KAAiBD,IAAI,GAAGC,KAA3D;AACAtF,MAAM,CAACoF,mBAAP,CAA2BhD,MAA3B,EAAmC,CAACiD,IAAD,EAAOC,KAAP,KAAiBD,IAAI,GAAGC,KAA3D;AAEAtF,MAAM,CAACoF,mBAAP,CAA2B9C,OAA3B,EAAqC+C,IAAD,IAAUzG,KAAK,CAACyG,IAAD,CAAnD;AACArF,MAAM,CAACoF,mBAAP,CAA2B5C,SAA3B,EAAuC6C,IAAD,IAAUxG,OAAO,CAACwG,IAAD,CAAvD;AACArF,MAAM,CAACoF,mBAAP,CAA2B1C,UAA3B,EAAwC2C,IAAD,IAAU/F,IAAI,CAAC+F,IAAD,EAAO,CAACa,KAAD,EAAQM,GAAR,KAAgB,CAACA,GAAD,EAAMN,KAAN,CAAvB,CAArD;AACAlG,MAAM,CAACoF,mBAAP,CAA2BxC,eAA3B,EAA6CyC,IAAD,IAAU/F,IAAI,CAAC+F,IAAD,EAAO,CAACoB,CAAD,EAAIC,CAAJ,MAAW;AAAEA,EAAAA,CAAF;AAAKD,EAAAA;AAAL,CAAX,CAAP,CAA1D;AAEAzG,MAAM,CAACoF,mBAAP,CAA2BtC,OAA3B,EAAoC,CAACuC,IAAD,EAAOC,KAAP,EAAcC,OAAd,KAA0B;AAC1D,MAAIF,IAAI,IAAI,IAAZ,EAAkB;AACd,WAAO,IAAP;AACH;;AAED,MAAI,OAAOC,KAAP,KAAiB,QAArB,EAA+B;AAC3BA,IAAAA,KAAK,GAAG,CAACA,KAAD,CAAR;AACH;;AAED,MAAII,KAAK,CAACC,OAAN,CAAcL,KAAd,CAAJ,EAA0B;AACtB,WAAOxG,KAAK,CAACuG,IAAD,EAAOC,KAAP,CAAZ;AACH;;AAED,SAAOvG,OAAO,CAACsG,IAAD,EAAO,CAACI,IAAD,EAAOe,GAAP,KACjBpG,IAAI,CAACoG,GAAD,EAAMrG,UAAU,CAACQ,KAAjB,EAAwB2E,KAAxB,EAA+BN,YAA/B,EAA6C/E,eAAe,CAACsF,OAAD,EAAUF,IAAV,EAAgBmB,GAAhB,EAAqBf,IAArB,CAA5D,CADM,CAAd;AAGH,CAhBD;AAkBAzF,MAAM,CAACoF,mBAAP,CAA2BpC,OAA3B,EAAoC,CAACqC,IAAD,EAAOC,KAAP,EAAcC,OAAd,KAA0B;AAC1D,MAAIF,IAAI,IAAI,IAAZ,EAAkB;AACd,WAAO,IAAP;AACH;;AAED,MAAI,OAAOC,KAAP,KAAiB,QAArB,EAA+B;AAC3BA,IAAAA,KAAK,GAAG,CAACA,KAAD,CAAR;AACH;;AAED,MAAII,KAAK,CAACC,OAAN,CAAcL,KAAd,CAAJ,EAA0B;AACtB,WAAOrG,KAAK,CAACoG,IAAD,EAAOC,KAAP,CAAZ;AACH;;AAED,SAAOpG,OAAO,CAACmG,IAAD,EAAO,CAACI,IAAD,EAAOe,GAAP,KACjBpG,IAAI,CAACoG,GAAD,EAAMrG,UAAU,CAACQ,KAAjB,EAAwB2E,KAAxB,EAA+BN,YAA/B,EAA6C/E,eAAe,CAACsF,OAAD,EAAUF,IAAV,EAAgBmB,GAAhB,EAAqBf,IAArB,CAA5D,CADM,CAAd;AAGH,CAhBD;AAkBAzF,MAAM,CAACoF,mBAAP,CAA2BlC,QAA3B,EAAqC,CAACmC,IAAD,EAAOC,KAAP,KAAiB;AAClD,MAAID,IAAI,IAAI,IAAZ,EAAkB;AACd,WAAO,IAAP;AACH;;AAED,MAAI,CAACK,KAAK,CAACC,OAAN,CAAcN,IAAd,CAAL,EAA0B;AACtB,WAAO,IAAIc,KAAJ,CAAU7F,GAAG,CAACqG,eAAJ,CAAoBzG,GAAG,CAACiD,KAAxB,CAAV,CAAP;AACH;;AAED,MAAIyC,MAAM,CAACC,SAAP,CAAiBP,KAAjB,CAAJ,EAA6B;AACzB,WAAOD,IAAI,CAACuB,KAAL,CAAWtB,KAAX,CAAP;AACH;;AAED,MAAII,KAAK,CAACC,OAAN,CAAcL,KAAd,CAAJ,EAA0B;AACtB,QAAIA,KAAK,CAACe,MAAN,KAAiB,CAAjB,IAAsBf,KAAK,CAACe,MAAN,GAAe,CAAzC,EAA4C;AACxC,aAAO,IAAIF,KAAJ,CAAU7F,GAAG,CAACuG,eAAJ,CAAoB3G,GAAG,CAACiD,KAAxB,EAA+BmC,KAA/B,CAAV,CAAP;AACH;;AAED,WAAOD,IAAI,CAACuB,KAAL,CAAW,GAAGtB,KAAd,CAAP;AACH;;AAED,SAAO,IAAIa,KAAJ,CAAU7F,GAAG,CAACuG,eAAJ,CAAoB3G,GAAG,CAACiD,KAAxB,EAA+BmC,KAA/B,CAAV,CAAP;AACH,CAtBD;AAwBAtF,MAAM,CAACoF,mBAAP,CAA2BhC,QAA3B,EAAqC,CAACiC,IAAD,EAAOC,KAAP,KAAiBnG,QAAQ,CAACkG,IAAD,EAAOC,KAAP,CAA9D;AACAtF,MAAM,CAACoF,mBAAP,CAA2B9B,OAA3B,EAAoC,CAAC+B,IAAD,EAAOC,KAAP,KAAiBlG,OAAO,CAACiG,IAAD,EAAOC,KAAP,CAA5D;AACAtF,MAAM,CAACoF,mBAAP,CAA2B5B,UAA3B,EAAwC6B,IAAD,IAAU1G,QAAQ,CAAC0G,IAAD,CAAzD;AAEArF,MAAM,CAACoF,mBAAP,CAA2B1B,OAA3B,EAAoC,CAAC2B,IAAD,EAAOC,KAAP,KAAiB;AACjD,MAAID,IAAI,IAAI,IAAZ,EAAkB;AACd,WAAO,IAAP;AACH;;AACD,MAAI,CAACK,KAAK,CAACC,OAAN,CAAcN,IAAd,CAAL,EAA0B;AACtB,UAAM,IAAIc,KAAJ,CAAU7F,GAAG,CAACqG,eAAJ,CAAoBzG,GAAG,CAACyD,IAAxB,CAAV,CAAN;AACH;;AAED,SAAO0B,IAAI,CAACyB,IAAL,CAAUxB,KAAK,CAACyB,QAAN,EAAV,CAAP;AACH,CATD;;AAWA,MAAMC,YAAY,GAAG,CAAC3B,IAAD,EAAOE,OAAP,KAAmB,CAAC,CAAC0B,MAAD,EAASC,IAAT,KAAkBC,MAAM,CAACC,MAAP,CAAcH,MAAd,EAAsB5G,SAAS,CAACgF,IAAD,EAAO6B,IAAP,EAAa3B,OAAb,CAA/B,CAAnB,EAA0E,EAA1E,CAAxC;;AAEA,MAAM8B,WAAW,GAAG,CAAChC,IAAD,EAAOE,OAAP,KAAmB,CAAC,CAAC0B,MAAD,EAASC,IAAT,KAAkB,CAAC,GAAGD,MAAJ,EAAY,GAAG5G,SAAS,CAACgF,IAAD,EAAO6B,IAAP,EAAa3B,OAAb,CAAxB,CAAnB,EAAmE,EAAnE,CAAvC;;AAEAvF,MAAM,CAACoF,mBAAP,CAA2BxB,QAA3B,EAAqC,CAACyB,IAAD,EAAOC,KAAP,EAAcC,OAAd,KAA0B;AAC3D,MAAI,CAACG,KAAK,CAACC,OAAN,CAAcL,KAAd,CAAL,EAA2B;AACvB,UAAM,IAAIa,KAAJ,CAAU7F,GAAG,CAAC8F,iBAAJ,CAAsBlG,GAAG,CAAC2D,KAA1B,CAAV,CAAN;AACH;;AAED,SAAOyB,KAAK,CAACgC,MAAN,CAAa,IAAI5B,KAAK,CAACC,OAAN,CAAcN,IAAd,IAAsBgC,WAAW,CAAChC,IAAD,EAAOE,OAAP,CAAjC,GAAmDyB,YAAY,CAAC3B,IAAD,EAAOE,OAAP,CAAnE,CAAb,CAAP;AACH,CAND;AAQAvF,MAAM,CAACoF,mBAAP,CAA2BtB,SAA3B,EAAsC,CAACuB,IAAD,EAAOC,KAAP,EAAcC,OAAd,KAA0B;AAC5D,MAAIF,IAAI,IAAI,IAAZ,EAAkB;AACd,WAAO,IAAP;AACH;;AAED,MAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AAC1B,UAAM,IAAIc,KAAJ,CAAU7F,GAAG,CAACiH,oBAAJ,CAAyBrH,GAAG,CAAC6D,MAA7B,CAAV,CAAN;AACH;;AAED,SAAO1E,OAAO,CAACgG,IAAD,EAAO,CAACa,KAAD,EAAQM,GAAR,KACjBpG,IAAI,CAAC8F,KAAD,EAAQ/F,UAAU,CAACQ,KAAnB,EAA0B2E,KAA1B,EAAiCN,YAAjC,EAA+C;AAC/CwC,IAAAA,IAAI,EAAElH,GAAG,CAACmH,QAAJ,CAAajB,GAAb,EAAkBjB,OAAO,CAACiC,IAA1B;AADyC,GAA/C,CADM,CAAd;AAKH,CAdD;AAeAxH,MAAM,CAACoF,mBAAP,CAA2BpB,QAA3B,EAAqC,CAACqB,IAAD,EAAOC,KAAP,KAAiB;AAClD,MAAID,IAAI,IAAI,IAAZ,EAAkB;AACd,WAAO,IAAP;AACH;;AAED,MAAI,OAAOA,IAAP,KAAgB,QAApB,EAA8B;AAC1B,UAAM,IAAIc,KAAJ,CAAU7F,GAAG,CAACiH,oBAAJ,CAAyBrH,GAAG,CAAC+D,KAA7B,CAAV,CAAN;AACH;;AAED,MAAIyB,KAAK,CAACC,OAAN,CAAcL,KAAd,CAAJ,EAA0B;AACtB,QAAIA,KAAK,CAACe,MAAN,KAAiB,CAArB,EAAwB;AACpB,YAAM,IAAIF,KAAJ,CAAU7F,GAAG,CAACoH,iBAAJ,CAAsBxH,GAAG,CAAC+D,KAA1B,CAAV,CAAN;AACH;;AAED,WAAOtE,KAAK,CAAC0F,IAAD,EAAOC,KAAK,CAAC,CAAD,CAAZ,EAAiBA,KAAK,CAAC,CAAD,CAAtB,CAAZ;AACH;;AAED,MAAI,CAAC1F,aAAa,CAAC0F,KAAD,CAAlB,EAA2B;AACvB,UAAM,IAAIa,KAAJ,CAAU7F,GAAG,CAACqH,kBAAJ,CAAuBzH,GAAG,CAAC+D,KAA3B,CAAV,CAAN;AACH;;AAED,SAAOtE,KAAK,CAAC0F,IAAD,EAAOC,KAAP,CAAZ;AACH,CAtBD;AAwBAtF,MAAM,CAACoF,mBAAP,CAA2BlB,UAA3B,EAAwCmB,IAAD,IAAWA,IAAI,IAAI,IAAR,GAAeA,IAAf,GAAsBuC,IAAI,CAACC,SAAL,CAAexC,IAAf,CAAxE;AACArF,MAAM,CAACoF,mBAAP,CAA2BhB,SAA3B,EAAuCiB,IAAD,IAAWA,IAAI,IAAI,IAAR,GAAeA,IAAf,GAAsBuC,IAAI,CAACE,KAAL,CAAWzC,IAAX,CAAvE;AAEArF,MAAM,CAACoF,mBAAP,CAA2Bd,MAA3B,EAAmC,CAACe,IAAD,EAAOC,KAAP,EAAcC,OAAd,KAA0BlF,SAAS,CAAC0H,SAAD,EAAYzC,KAAZ,EAAmBC,OAAnB,EAA4B,IAA5B,CAAtE;AACAvF,MAAM,CAACoF,mBAAP,CAA2BZ,WAA3B,EAAwC,CAACa,IAAD,EAAOC,KAAP,EAAcC,OAAd,KAA0B;AAC9D,MAAI,OAAOF,IAAP,KAAgB,QAApB,EAA8B;AAC1B,UAAM,IAAIc,KAAJ,CAAU7F,GAAG,CAACiH,oBAAJ,CAAyBrH,GAAG,CAACuE,QAA7B,CAAV,CAAN;AACH;;AAED,MAAIiB,KAAK,CAACC,OAAN,CAAcN,IAAd,CAAJ,EAAyB;AACrB,WAAOA,IAAI,CAAC2C,MAAL,CAAY3H,SAAS,CAACgF,IAAD,EAAOC,KAAP,EAAcC,OAAd,CAArB,CAAP;AACH;;AAED,MAAI,CAACG,KAAK,CAACC,OAAN,CAAcL,KAAd,CAAD,IAAyBA,KAAK,CAACe,MAAN,KAAiB,CAA9C,EAAiD;AAC7C,UAAM,IAAIF,KAAJ,CAAU7F,GAAG,CAACoH,iBAAJ,CAAsBxH,GAAG,CAACuE,QAA1B,CAAV,CAAN;AACH;;AAED,SAAO,EACH,GAAGY,IADA;AAEH,KAACC,KAAK,CAAC,CAAD,CAAN,GAAYjF,SAAS,CAACgF,IAAD,EAAOC,KAAK,CAAC,CAAD,CAAZ,EAAiBC,OAAjB;AAFlB,GAAP;AAIH,CAjBD;AAkBAvF,MAAM,CAACoF,mBAAP,CAA2BV,SAA3B,EAAsC,CAACW,IAAD,EAAOC,KAAP,EAAcC,OAAd,KAA0B;AAC5D,MAAI,CAAC3F,aAAa,CAACyF,IAAD,CAAlB,EAA0B;AACtB,QAAIA,IAAI,IAAI,IAAZ,EAAkB;AACdA,MAAAA,IAAI,GAAG,EAAP;AACH,KAFD,MAEO;AACH,YAAM,IAAIc,KAAJ,CAAU7F,GAAG,CAAC2H,gBAAJ,CAAqB/H,GAAG,CAACyE,MAAzB,CAAV,CAAN;AACH;AACJ;;AAED,MAAI,CAAC/E,aAAa,CAAC0F,KAAD,CAAlB,EAA2B;AACvB,UAAM,IAAIa,KAAJ,CAAU7F,GAAG,CAACqH,kBAAJ,CAAuBzH,GAAG,CAACyE,MAA3B,CAAV,CAAN;AACH;;AAED,QAAMuD,UAAU,GAAG3I,UAAU,CAAC+F,KAAD,EAAQ,CAAC4B,IAAD,EAAOV,GAAP,KACjCnG,SAAS,CAACgF,IAAI,CAACmB,GAAD,CAAL,EAAYU,IAAZ,EAAkBjH,eAAe,CAACsF,OAAD,EAAUF,IAAV,EAAgBmB,GAAhB,EAAqBnB,IAAI,CAACmB,GAAD,CAAzB,CAAjC,CADgB,CAA7B;;AAIA,SAAO,EAAE,GAAGnB,IAAL;AAAW,OAAG6C;AAAd,GAAP;AACH,CAlBD;AAoBAlI,MAAM,CAACoF,mBAAP,CAA2BR,QAA3B,EAAqCvE,SAArC;AAEAL,MAAM,CAACoF,mBAAP,CAA2BN,cAA3B,EAA2C,CAACO,IAAD,EAAOC,KAAP,KAAiB;AACxD,MAAI,OAAOD,IAAP,KAAgB,QAApB,EAA8B;AAC1B,UAAM,IAAIc,KAAJ,CAAU7F,GAAG,CAAC6H,gBAAJ,CAAqBjI,GAAG,CAAC6E,WAAzB,CAAV,CAAN;AACH;;AAED,MAAIO,KAAK,IAAI,IAAT,IAAiB,OAAOA,KAAP,KAAiB,QAAtC,EAAgD;AAC5C,UAAM,IAAIa,KAAJ,CAAU7F,GAAG,CAACqH,kBAAJ,CAAuBzH,GAAG,CAAC6E,WAA3B,CAAV,CAAN;AACH;;AAED,SAAOhF,QAAQ,CAACsF,IAAD,EAAOC,KAAP,CAAf;AACH,CAVD;AAYA,eAAejF,SAAf","sourcesContent":["// JSON Expression Syntax (JES)\nimport _size from 'lodash/size';\nimport _reduce from 'lodash/reduce';\nimport _reverse from 'lodash/reverse';\nimport _keys from 'lodash/keys';\nimport _values from 'lodash/values';\nimport _pick from 'lodash/pick';\nimport _pickBy from 'lodash/pickBy';\nimport _nth from 'lodash/nth';\nimport _omit from 'lodash/omit';\nimport _omitBy from 'lodash/omitBy';\nimport _groupBy from 'lodash/groupBy';\nimport _sortBy from 'lodash/sortBy';\nimport _filter from 'lodash/filter';\nimport _map from 'lodash/map';\nimport _mapValues from 'lodash/mapValues';\nimport _findIndex from 'lodash/findIndex';\nimport _findKey from 'lodash/findKey';\nimport _isEqual from 'lodash/isEqual';\n\nimport { remap, isPlainObject, get as _get, template } from '@genx/july';\n\nimport config, { getChildContext } from './config';\nimport ops from './transformerOperators';\nimport validators from './validateOperators';\nimport { test } from './validate';\nimport './validators';\nimport transform from './transform';\n\nconst MSG = config.messages;\n\nconst UNARY = true;\nconst BINARY = false;\n\n//Query & aggregate operators (pure)\nconst OP_MATCH = [ops.MATCH, BINARY, '$has', '$match', '$all', '$validate', '$when'];\nconst OP_SIZE = [ops.SIZE, UNARY, '$size', '$length', '$count'];\nconst OP_SUM = [ops.SUM, UNARY, '$sum', '$total'];\nconst OP_GET_TYPE = [ops.GET_TYPE, UNARY, '$type'];\nconst OP_GET_BY_INDEX = [ops.GET_BY_INDEX, BINARY, '$at', '$getByIndex', '$nth']; // supports -1 as the last index, -2 the second last\nconst OP_GET_BY_KEY = [ops.GET_BY_KEY, BINARY, '$of', '$valueOf', '$getByKey']; // support key path\nconst OP_FIND = [ops.FIND, BINARY, '$indexOf', '$keyOf'];\nconst OP_IF = [ops.IF, BINARY, '$if'];\nconst OP_CAST_ARRAY = [ops.CAST_ARRAY, UNARY, '$castArray', '$makeArray'];\n\n//Math operators (pure)\nconst OP_ADD = [ops.ADD, BINARY, '$add', '$plus', '$inc'];\nconst OP_SUB = [ops.SUB, BINARY, '$sub', '$subtract', '$minus', '$dec'];\nconst OP_MUL = [ops.MUL, BINARY, '$mul', '$multiply', '$times'];\nconst OP_DIV = [ops.DIV, BINARY, '$div', '$divide'];\nconst OP_MOD = [ops.MOD, BINARY, '$mod', '$remainder'];\n\n//Collection operators (pure)\nconst OP_KEYS = [ops.KEYS, UNARY, '$keys'];\nconst OP_VALUES = [ops.VALUES, UNARY, '$values'];\nconst OP_ENTRIES = [ops.ENTRIES, UNARY, '$entries'];\nconst OP_OBJ_TO_ARRAY = [ops.OBJ_TO_ARRAY, UNARY, '$toArray', '$objectToArray'];\nconst OP_PICK = [ops.PICK, BINARY, '$pick', '$pickBy', '$filterByKeys']; // filter by key\nconst OP_OMIT = [ops.OMIT, BINARY, '$omit', '$omitBy'];\nconst OP_SLICE = [ops.SLICE, BINARY, '$slice', '$limit'];\nconst OP_GROUP = [ops.GROUP, BINARY, '$group', '$groupBy'];\nconst OP_SORT = [ops.SORT, BINARY, '$sort', '$orderBy', '$sortBy'];\nconst OP_REVERSE = [ops.REVERSE, UNARY, '$reverse'];\nconst OP_JOIN = [ops.JOIN, BINARY, '$join'];\nconst OP_MERGE = [ops.MERGE, BINARY, '$merge']; // merge a list of transform result over the value\nconst OP_FILTER = [ops.FILTER, BINARY, '$filter', '$select', '$filterByValue']; // filter by value\nconst OP_REMAP = [ops.REMAP, BINARY, '$remap', '$mapKeys']; // reverse-map, map a key to another name\nconst OP_TO_JSON = [ops.TO_JSON, UNARY, '$json', '$toJSON', '$stringify'];\nconst OP_TO_OBJ = [ops.TO_OBJ, UNARY, '$object', '$toObject', '$parseJSON'];\n\n//Value updater (pure)\nconst OP_SET = [ops.SET, BINARY, '$set', '$=', '$value'];\nconst OP_ADD_ITEM = [ops.ADD_ITEM, BINARY, '$addItem', '$addFields'];\nconst OP_ASSIGN = [ops.ASSIGN, BINARY, '$assign', '$override'];\nconst OP_APPLY = [ops.APPLY, BINARY, '$apply', '$eval']; // to be used in collection\n\n//String manipulate\nconst OP_INTERPOLATE = [ops.INTERPOLATE, BINARY, '$interpolate', '$template'];\n\n// [ <op name>, <unary> ]\n//embeded validators in processing pipeline\nconst matchOptions = { throwError: false, abortEarly: true, asPredicate: true };\n\nconfig.addTransformerToMap(OP_MATCH, (left, right, context) =>\n    test(left, validators.MATCH, right, matchOptions, context)\n);\n\nconfig.addTransformerToMap(OP_SIZE, (left) => _size(left));\n\nconfig.addTransformerToMap(OP_SUM, (left) =>\n    _reduce(\n        left,\n        (sum, item) => {\n            sum += item;\n            return sum;\n        },\n        0\n    )\n);\n\nconfig.addTransformerToMap(OP_GET_TYPE, (left) =>\n    Array.isArray(left) ? 'array' : Number.isInteger(left) ? 'integer' : typeof left\n);\n\nconfig.addTransformerToMap(OP_GET_BY_INDEX, (left, right) => _nth(left, right));\nconfig.addTransformerToMap(OP_GET_BY_KEY, (left, right) => _get(left, right));\n\nconfig.addTransformerToMap(OP_FIND, (left, right, context) => {\n    const targetValue = transform(null, right, context);\n    console.log(left, targetValue, context);\n    const predicate = (value) => _isEqual(value, targetValue);\n    return Array.isArray(left) ? _findIndex(left, predicate) : _findKey(left, predicate);\n});\n\nconfig.addTransformerToMap(OP_IF, (left, right, context) => {\n    if (!Array.isArray(right)) {\n        throw new Error(MSG.OPERAND_NOT_ARRAY(ops.IF));\n    }\n\n    if (right.length < 2 || right.length > 3) {\n        throw new Error(MSG.OPERAND_NOT_TUPLE_2_OR_3(ops.IF));\n    }\n\n    const condition = transform(left, right[0], context);\n\n    if (condition) {\n        return transform(left, right[1], context);\n    } else if (right.length > 2) {\n        return transform(left, right[2], context);\n    }\n\n    return left;\n});\n\nconfig.addTransformerToMap(OP_CAST_ARRAY, (left) => (left == null ? null : Array.isArray(left) ? left : [left]));\n\nconfig.addTransformerToMap(OP_ADD, (left, right) => left + right);\nconfig.addTransformerToMap(OP_SUB, (left, right) => left - right);\nconfig.addTransformerToMap(OP_MUL, (left, right) => left * right);\nconfig.addTransformerToMap(OP_DIV, (left, right) => left / right);\nconfig.addTransformerToMap(OP_MOD, (left, right) => left % right);\n\nconfig.addTransformerToMap(OP_KEYS, (left) => _keys(left));\nconfig.addTransformerToMap(OP_VALUES, (left) => _values(left));\nconfig.addTransformerToMap(OP_ENTRIES, (left) => _map(left, (value, key) => [key, value]));\nconfig.addTransformerToMap(OP_OBJ_TO_ARRAY, (left) => _map(left, (v, k) => ({ k, v })));\n\nconfig.addTransformerToMap(OP_PICK, (left, right, context) => {\n    if (left == null) {\n        return null;\n    }\n\n    if (typeof right !== 'object') {\n        right = [right];\n    }\n\n    if (Array.isArray(right)) {\n        return _pick(left, right);\n    }\n\n    return _pickBy(left, (item, key) =>\n        test(key, validators.MATCH, right, matchOptions, getChildContext(context, left, key, item))\n    );\n});\n\nconfig.addTransformerToMap(OP_OMIT, (left, right, context) => {\n    if (left == null) {\n        return null;\n    }\n\n    if (typeof right !== 'object') {\n        right = [right];\n    }\n\n    if (Array.isArray(right)) {\n        return _omit(left, right);\n    }\n\n    return _omitBy(left, (item, key) =>\n        test(key, validators.MATCH, right, matchOptions, getChildContext(context, left, key, item))\n    );\n});\n\nconfig.addTransformerToMap(OP_SLICE, (left, right) => {\n    if (left == null) {\n        return null;\n    }\n\n    if (!Array.isArray(left)) {\n        return new Error(MSG.VALUE_NOT_ARRAY(ops.SLICE));\n    }\n\n    if (Number.isInteger(right)) {\n        return left.slice(right);\n    }\n\n    if (Array.isArray(right)) {\n        if (right.length === 0 || right.length > 2) {\n            return new Error(MSG.INVALID_OP_EXPR(ops.SLICE, right));\n        }\n\n        return left.slice(...right);\n    }\n\n    return new Error(MSG.INVALID_OP_EXPR(ops.SLICE, right));\n});\n\nconfig.addTransformerToMap(OP_GROUP, (left, right) => _groupBy(left, right));\nconfig.addTransformerToMap(OP_SORT, (left, right) => _sortBy(left, right));\nconfig.addTransformerToMap(OP_REVERSE, (left) => _reverse(left));\n\nconfig.addTransformerToMap(OP_JOIN, (left, right) => {\n    if (left == null) {\n        return null;\n    }\n    if (!Array.isArray(left)) {\n        throw new Error(MSG.VALUE_NOT_ARRAY(ops.JOIN));\n    }\n\n    return left.join(right.toString());\n});\n\nconst objectMerger = (left, context) => [(result, expr) => Object.assign(result, transform(left, expr, context)), {}];\n\nconst arrayMerger = (left, context) => [(result, expr) => [...result, ...transform(left, expr, context)], []];\n\nconfig.addTransformerToMap(OP_MERGE, (left, right, context) => {\n    if (!Array.isArray(right)) {\n        throw new Error(MSG.OPERAND_NOT_ARRAY(ops.MERGE));\n    }\n\n    return right.reduce(...(Array.isArray(left) ? arrayMerger(left, context) : objectMerger(left, context)));\n});\n\nconfig.addTransformerToMap(OP_FILTER, (left, right, context) => {\n    if (left == null) {\n        return null;\n    }\n\n    if (typeof left !== 'object') {\n        throw new Error(MSG.VALUE_NOT_COLLECTION(ops.FILTER));\n    }\n\n    return _filter(left, (value, key) =>\n        test(value, validators.MATCH, right, matchOptions, {\n            path: MSG.makePath(key, context.path),\n        })\n    );\n});\nconfig.addTransformerToMap(OP_REMAP, (left, right) => {\n    if (left == null) {\n        return null;\n    }\n\n    if (typeof left !== 'object') {\n        throw new Error(MSG.VALUE_NOT_COLLECTION(ops.REMAP));\n    }\n\n    if (Array.isArray(right)) {\n        if (right.length !== 2) {\n            throw new Error(MSG.OPERAND_NOT_TUPLE(ops.REMAP));\n        }\n\n        return remap(left, right[0], right[1]);\n    }\n\n    if (!isPlainObject(right)) {\n        throw new Error(MSG.OPERAND_NOT_OBJECT(ops.REMAP));\n    }\n\n    return remap(left, right);\n});\n\nconfig.addTransformerToMap(OP_TO_JSON, (left) => (left == null ? left : JSON.stringify(left)));\nconfig.addTransformerToMap(OP_TO_OBJ, (left) => (left == null ? left : JSON.parse(left)));\n\nconfig.addTransformerToMap(OP_SET, (left, right, context) => transform(undefined, right, context, true));\nconfig.addTransformerToMap(OP_ADD_ITEM, (left, right, context) => {\n    if (typeof left !== 'object') {\n        throw new Error(MSG.VALUE_NOT_COLLECTION(ops.ADD_ITEM));\n    }\n\n    if (Array.isArray(left)) {\n        return left.concat(transform(left, right, context));\n    }\n\n    if (!Array.isArray(right) || right.length !== 2) {\n        throw new Error(MSG.OPERAND_NOT_TUPLE(ops.ADD_ITEM));\n    }\n\n    return {\n        ...left,\n        [right[0]]: transform(left, right[1], context),\n    };\n});\nconfig.addTransformerToMap(OP_ASSIGN, (left, right, context) => {\n    if (!isPlainObject(left)) {\n        if (left == null) {\n            left = {};\n        } else {\n            throw new Error(MSG.VALUE_NOT_OBJECT(ops.ASSIGN));\n        }\n    }\n\n    if (!isPlainObject(right)) {\n        throw new Error(MSG.OPERAND_NOT_OBJECT(ops.ASSIGN));\n    }\n\n    const rightValue = _mapValues(right, (expr, key) =>\n        transform(left[key], expr, getChildContext(context, left, key, left[key]))\n    );\n\n    return { ...left, ...rightValue };\n});\n\nconfig.addTransformerToMap(OP_APPLY, transform);\n\nconfig.addTransformerToMap(OP_INTERPOLATE, (left, right) => {\n    if (typeof left !== 'string') {\n        throw new Error(MSG.VALUE_NOT_STRING(ops.INTERPOLATE));\n    }\n\n    if (right != null && typeof right !== 'object') {\n        throw new Error(MSG.OPERAND_NOT_OBJECT(ops.INTERPOLATE));\n    }\n\n    return template(left, right);\n});\n\nexport default transform;\n"]}