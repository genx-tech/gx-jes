{"version":3,"file":"object.js","names":["_find2","_interopRequireDefault","require","_july","_ValidationError","_config","_validate","_interopRequireWildcard","_getRequireWildcardCache","nodeInterop","WeakMap","cacheBabelInterop","cacheNodeInterop","obj","__esModule","default","cache","has","get","newObj","hasPropertyDescriptor","Object","defineProperty","getOwnPropertyDescriptor","key","prototype","hasOwnProperty","call","desc","set","validateBySchema","value","schema","options","useFieldPath","abortEarly","throwError","context","mapOfNames","invalidType","errors","_options","_find","validationObject","fieldName","fieldValue","_get","reason","validate","path","messages","makePath","$$PARENT","$$CURRENT","ValidationError","push","length","_default","name","alias","exports"],"sources":["../../src/types/object.js"],"sourcesContent":["import _find from 'lodash/find';\nimport { get as _get } from '@genx/july';\n\nimport ValidationError from '../ValidationError';\nimport { messages } from '../config';\nimport validate, { invalidType } from '../validate';\n\nexport function validateBySchema(\n    value,\n    schema,\n    options = { useFieldPath: true, abortEarly: true, throwError: true },\n    context = {}\n) {\n    const { useFieldPath, abortEarly, throwError, mapOfNames } = options;\n\n    if (value != null && typeof value !== 'object') {\n        return invalidType(value, 'object', options, context);\n    }\n\n    if (typeof schema === 'function') {\n        // use deferred activation of schema to avoid circullar reference\n        schema = schema();\n    }\n\n    const errors = [];\n    const _options = !abortEarly && throwError ? { ...options, throwError: false } : options;\n\n    _find(schema, (validationObject, fieldName) => {\n        const fieldValue = useFieldPath ? _get(value, fieldName) : value?.[fieldName];\n        const reason = validate(fieldValue, validationObject, _options, {\n            path: messages.makePath(mapOfNames?.[fieldName] ?? fieldName, context.path),\n            $$PARENT: value,\n            $$CURRENT: fieldValue,\n        });\n\n        if (reason !== true) {\n            if (abortEarly && throwError) {\n                throw new ValidationError(reason, fieldValue, fieldName);\n            }\n\n            errors.push(...reason);\n            return abortEarly;\n        }\n\n        return false;\n    });\n\n    if (errors.length > 0) {\n        if (throwError) {\n            throw new ValidationError(errors, value, context.path);\n        }\n\n        return errors;\n    }\n\n    return true;\n}\n\nexport default {\n    name: 'object',\n\n    alias: ['json'],\n\n    validate: validateBySchema,\n};\n"],"mappings":";;;;;;;;AAAA,IAAAA,MAAA,GAAAC,sBAAA,CAAAC,OAAA;AACA,IAAAC,KAAA,GAAAD,OAAA;AAEA,IAAAE,gBAAA,GAAAH,sBAAA,CAAAC,OAAA;AACA,IAAAG,OAAA,GAAAH,OAAA;AACA,IAAAI,SAAA,GAAAC,uBAAA,CAAAL,OAAA;AAAoD,SAAAM,yBAAAC,WAAA,eAAAC,OAAA,kCAAAC,iBAAA,OAAAD,OAAA,QAAAE,gBAAA,OAAAF,OAAA,YAAAF,wBAAA,YAAAA,CAAAC,WAAA,WAAAA,WAAA,GAAAG,gBAAA,GAAAD,iBAAA,KAAAF,WAAA;AAAA,SAAAF,wBAAAM,GAAA,EAAAJ,WAAA,SAAAA,WAAA,IAAAI,GAAA,IAAAA,GAAA,CAAAC,UAAA,WAAAD,GAAA,QAAAA,GAAA,oBAAAA,GAAA,wBAAAA,GAAA,4BAAAE,OAAA,EAAAF,GAAA,UAAAG,KAAA,GAAAR,wBAAA,CAAAC,WAAA,OAAAO,KAAA,IAAAA,KAAA,CAAAC,GAAA,CAAAJ,GAAA,YAAAG,KAAA,CAAAE,GAAA,CAAAL,GAAA,SAAAM,MAAA,WAAAC,qBAAA,GAAAC,MAAA,CAAAC,cAAA,IAAAD,MAAA,CAAAE,wBAAA,WAAAC,GAAA,IAAAX,GAAA,QAAAW,GAAA,kBAAAH,MAAA,CAAAI,SAAA,CAAAC,cAAA,CAAAC,IAAA,CAAAd,GAAA,EAAAW,GAAA,SAAAI,IAAA,GAAAR,qBAAA,GAAAC,MAAA,CAAAE,wBAAA,CAAAV,GAAA,EAAAW,GAAA,cAAAI,IAAA,KAAAA,IAAA,CAAAV,GAAA,IAAAU,IAAA,CAAAC,GAAA,KAAAR,MAAA,CAAAC,cAAA,CAAAH,MAAA,EAAAK,GAAA,EAAAI,IAAA,YAAAT,MAAA,CAAAK,GAAA,IAAAX,GAAA,CAAAW,GAAA,SAAAL,MAAA,CAAAJ,OAAA,GAAAF,GAAA,MAAAG,KAAA,IAAAA,KAAA,CAAAa,GAAA,CAAAhB,GAAA,EAAAM,MAAA,YAAAA,MAAA;AAAA,SAAAlB,uBAAAY,GAAA,WAAAA,GAAA,IAAAA,GAAA,CAAAC,UAAA,GAAAD,GAAA,KAAAE,OAAA,EAAAF,GAAA;AAE7C,SAASiB,gBAAgBA,CAC5BC,KAAK,EACLC,MAAM,EACNC,OAAO,GAAG;EAAEC,YAAY,EAAE,IAAI;EAAEC,UAAU,EAAE,IAAI;EAAEC,UAAU,EAAE;AAAK,CAAC,EACpEC,OAAO,GAAG,CAAC,CAAC,EACd;EACE,MAAM;IAAEH,YAAY;IAAEC,UAAU;IAAEC,UAAU;IAAEE;EAAW,CAAC,GAAGL,OAAO;EAEpE,IAAIF,KAAK,IAAI,IAAI,IAAI,OAAOA,KAAK,KAAK,QAAQ,EAAE;IAC5C,OAAO,IAAAQ,qBAAW,EAACR,KAAK,EAAE,QAAQ,EAAEE,OAAO,EAAEI,OAAO,CAAC;EACzD;EAEA,IAAI,OAAOL,MAAM,KAAK,UAAU,EAAE;IAE9BA,MAAM,GAAGA,MAAM,CAAC,CAAC;EACrB;EAEA,MAAMQ,MAAM,GAAG,EAAE;EACjB,MAAMC,QAAQ,GAAG,CAACN,UAAU,IAAIC,UAAU,GAAG;IAAE,GAAGH,OAAO;IAAEG,UAAU,EAAE;EAAM,CAAC,GAAGH,OAAO;EAExF,IAAAS,cAAK,EAACV,MAAM,EAAE,CAACW,gBAAgB,EAAEC,SAAS,KAAK;IAC3C,MAAMC,UAAU,GAAGX,YAAY,GAAG,IAAAY,SAAI,EAACf,KAAK,EAAEa,SAAS,CAAC,GAAGb,KAAK,aAALA,KAAK,uBAALA,KAAK,CAAGa,SAAS,CAAC;IAC7E,MAAMG,MAAM,GAAG,IAAAC,iBAAQ,EAACH,UAAU,EAAEF,gBAAgB,EAAEF,QAAQ,EAAE;MAC5DQ,IAAI,EAAEC,gBAAQ,CAACC,QAAQ,CAAC,CAAAb,UAAU,aAAVA,UAAU,uBAAVA,UAAU,CAAGM,SAAS,CAAC,KAAIA,SAAS,EAAEP,OAAO,CAACY,IAAI,CAAC;MAC3EG,QAAQ,EAAErB,KAAK;MACfsB,SAAS,EAAER;IACf,CAAC,CAAC;IAEF,IAAIE,MAAM,KAAK,IAAI,EAAE;MACjB,IAAIZ,UAAU,IAAIC,UAAU,EAAE;QAC1B,MAAM,IAAIkB,wBAAe,CAACP,MAAM,EAAEF,UAAU,EAAED,SAAS,CAAC;MAC5D;MAEAJ,MAAM,CAACe,IAAI,CAAC,GAAGR,MAAM,CAAC;MACtB,OAAOZ,UAAU;IACrB;IAEA,OAAO,KAAK;EAChB,CAAC,CAAC;EAEF,IAAIK,MAAM,CAACgB,MAAM,GAAG,CAAC,EAAE;IACnB,IAAIpB,UAAU,EAAE;MACZ,MAAM,IAAIkB,wBAAe,CAACd,MAAM,EAAET,KAAK,EAAEM,OAAO,CAACY,IAAI,CAAC;IAC1D;IAEA,OAAOT,MAAM;EACjB;EAEA,OAAO,IAAI;AACf;AAAC,IAAAiB,QAAA,GAEc;EACXC,IAAI,EAAE,QAAQ;EAEdC,KAAK,EAAE,CAAC,MAAM,CAAC;EAEfX,QAAQ,EAAElB;AACd,CAAC;AAAA8B,OAAA,CAAA7C,OAAA,GAAA0C,QAAA"}