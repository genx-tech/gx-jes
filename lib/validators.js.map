{"version":3,"file":"validators.js","names":["MSG","config","messages","processRightValue","right","context","isPlainObject","transform","undefined","OP_EQUAL","ops","EQUAL","OP_NOT_EQUAL","NOT_EQUAL","OP_NOT","NOT","OP_GREATER_THAN","GREATER_THAN","OP_GREATER_THAN_OR_EQUAL","GREATER_THAN_OR_EQUAL","OP_LESS_THAN","LESS_THAN","OP_LESS_THAN_OR_EQUAL","LESS_THAN_OR_EQUAL","OP_LENGTH","LENGTH","OP_IN","IN","OP_NOT_IN","NOT_IN","OP_EXISTS","EXISTS","OP_REQUIRED","REQUIRED","OP_MATCH","MATCH","OP_MATCH_ANY","MATCH_ANY","OP_ALL_MATCH","ALL_MATCH","OP_ANY_ONE_MATCH","ANY_ONE_MATCH","OP_TYPE","TYPE","OP_HAS_KEYS","HAS_KEYS","OP_START_WITH","START_WITH","OP_END_WITH","END_WITH","OP_SAME_AS","SAME_AS","addValidatorToMap","left","options","_isEqual","args","test","_size","Array","isArray","Error","OPERAND_NOT_ARRAY","equal","getValidator","find","element","notEqual","every","OPERAND_NOT_BOOL","errors","rule","reason","validate","asPredicate","push","_castArray","abortEarly","length","throwError","ValidationError","path","$$ERROR","plainError","reason2","found","validationErrors","name","VALUE_NOT_ARRAY","leftItem","type","schema","INVALID_OP_EXPR","Types","Builtin","has","UNSUPPORTED_TYPE","key","_has","OPERAND_NOT_STRING","startsWith","endsWith","VALUE_NOT_PRIMITIVE","$$PARENT"],"sources":["../src/validators.js"],"sourcesContent":["// JSON Expression Syntax (JES) for validation\nimport _isEqual from 'lodash/isEqual';\nimport _has from 'lodash/has';\nimport _size from 'lodash/size';\nimport _castArray from 'lodash/castArray';\n\nimport ValidationError from './ValidationError';\nimport validate, { test } from './validate';\n\nimport config from './config';\nimport Types from './types';\nimport ops from './validateOperators';\nimport { isPlainObject } from '@genx/july';\nimport transform from './transform';\n\nconst MSG = config.messages;\n\nconst processRightValue = (right, context) =>\n    typeof right === 'string' || isPlainObject(right) ? transform(undefined, right, context, true) : right;\n\n//Validators [ name, ...operator alias ]\nconst OP_EQUAL = [ops.EQUAL, '$eq', '$eql', '$equal', '$being'];\nconst OP_NOT_EQUAL = [ops.NOT_EQUAL, '$ne', '$neq', '$notEqual'];\nconst OP_NOT = [ops.NOT, '$not'];\nconst OP_GREATER_THAN = [ops.GREATER_THAN, '$gt', '$>', '$greaterThan'];\nconst OP_GREATER_THAN_OR_EQUAL = [ops.GREATER_THAN_OR_EQUAL, '$gte', '$>=', '$greaterThanOrEqual', '$min'];\nconst OP_LESS_THAN = [ops.LESS_THAN, '$lt', '$<', '$lessThan'];\nconst OP_LESS_THAN_OR_EQUAL = [ops.LESS_THAN_OR_EQUAL, '$lte', '$<=', '$lessThanOrEqual', '$max'];\nconst OP_LENGTH = [ops.LENGTH, '$length', '$size', '$capacity'];\nconst OP_IN = [ops.IN, '$in'];\nconst OP_NOT_IN = [ops.NOT_IN, '$nin', '$notIn'];\nconst OP_EXISTS = [ops.EXISTS, '$exist', '$exists', '$notNull'];\nconst OP_REQUIRED = [ops.REQUIRED, '$required', '$mandatory'];\nconst OP_MATCH = [ops.MATCH, '$has', '$match', '$all', '$should'];\nconst OP_MATCH_ANY = [ops.MATCH_ANY, '$any', '$or', '$either'];\nconst OP_ALL_MATCH = [ops.ALL_MATCH, '$allMatch', '|>$all', '|>$match'];\nconst OP_ANY_ONE_MATCH = [ops.ANY_ONE_MATCH, '$anyOneMatch', '|*$any', '|*$match', '|*$either'];\nconst OP_TYPE = [ops.TYPE, '$is', '$typeOf'];\nconst OP_HAS_KEYS = [ops.HAS_KEYS, '$hasKey', '$hasKeys', '$withKey', '$withKeys'];\nconst OP_START_WITH = [ops.START_WITH, '$startWith', '$startsWith'];\nconst OP_END_WITH = [ops.END_WITH, '$endWith', '$endsWith'];\nconst OP_SAME_AS = [ops.SAME_AS, '$sameAs'];\n\nconfig.addValidatorToMap(OP_EQUAL, (left, right, options, context) =>\n    _isEqual(left, processRightValue(right, context))\n);\nconfig.addValidatorToMap(\n    OP_NOT_EQUAL,\n    (left, right, options, context) => !_isEqual(left, processRightValue(right, context))\n);\nconfig.addValidatorToMap(OP_NOT, (left, ...args) => !test(left, ops.MATCH, ...args));\nconfig.addValidatorToMap(OP_GREATER_THAN, (left, right, options, context) => left > processRightValue(right, context));\nconfig.addValidatorToMap(\n    OP_GREATER_THAN_OR_EQUAL,\n    (left, right, options, context) => left >= processRightValue(right, context)\n);\nconfig.addValidatorToMap(OP_LESS_THAN, (left, right, options, context) => left < processRightValue(right, context));\nconfig.addValidatorToMap(\n    OP_LESS_THAN_OR_EQUAL,\n    (left, right, options, context) => left <= processRightValue(right, context)\n);\nconfig.addValidatorToMap(OP_LENGTH, (left, right, options, context) =>\n    test(_size(left), ops.MATCH, right, options, context)\n);\n\nconfig.addValidatorToMap(OP_IN, (left, right, options, context) => {\n    if (right == null) {\n        return false;\n    }\n\n    right = processRightValue(right, context);\n\n    if (!Array.isArray(right)) {\n        throw new Error(MSG.OPERAND_NOT_ARRAY(ops.IN));\n    }\n\n    const equal = config.getValidator(ops.EQUAL);\n    return right.find((element) => equal(left, element));\n});\n\nconfig.addValidatorToMap(OP_NOT_IN, (left, right, options, context) => {\n    if (right == null) {\n        return true;\n    }\n\n    right = processRightValue(right, context);\n\n    if (!Array.isArray(right)) {\n        throw new Error(MSG.OPERAND_NOT_ARRAY(ops.NOT_IN));\n    }\n\n    const notEqual = config.getValidator(ops.NOT_EQUAL);\n\n    return right.every((element) => notEqual(left, element));\n});\n\nconfig.addValidatorToMap(OP_EXISTS, (left, right) => {\n    if (typeof right !== 'boolean') {\n        throw new Error(MSG.OPERAND_NOT_BOOL(ops.EXISTS));\n    }\n\n    return right ? left != null : left == null;\n});\n\nconfig.addValidatorToMap(OP_REQUIRED, (left, right) => {\n    if (typeof right !== 'boolean') {\n        throw new Error(MSG.OPERAND_NOT_BOOL(ops.OP_REQUIRED));\n    }\n\n    return right ? left != null : true;\n});\n\nconfig.addValidatorToMap(OP_MATCH, (left, right, options, context) => {\n    if (Array.isArray(right)) {\n        const errors = [];\n\n        right.every((rule) => {\n            const reason = validate(left, rule, { ...options, asPredicate: false }, context);\n            if (reason !== true) {\n                errors.push(..._castArray(reason));\n\n                if (options.abortEarly) {\n                    return false;\n                }\n            }\n\n            return true;\n        });\n\n        if (errors.length > 0) {\n            if (options.throwError) {\n                throw new ValidationError(errors, left, context.path);\n            }\n\n            if (!options.asPredicate) {\n                context.$$ERROR = errors.length === 1 && options.plainError ? errors[0] : errors;\n            }\n\n            return false;\n        }\n\n        return true;\n    }\n\n    const reason2 = validate(left, right, options, context);\n    if (reason2 !== true) {\n        if (!options.asPredicate) {\n            context.$$ERROR = reason2;\n        }\n\n        return false;\n    }\n\n    return true;\n});\n\nconfig.addValidatorToMap(OP_MATCH_ANY, (left, right, options, context) => {\n    if (!Array.isArray(right)) {\n        throw new Error(MSG.OPERAND_NOT_ARRAY(ops.MATCH_ANY));\n    }\n\n    let found = right.find((rule) => {\n        const reason = validate(left, rule, { ...options, abortEarly: false, throwError: false }, context);\n        return reason === true;\n    });\n\n    if (!found) {\n        context.$$ERROR = MSG.validationErrors[ops.MATCH_ANY](context.name, left, right, context);\n    }\n\n    return found ? true : false;\n});\n\nconfig.addValidatorToMap(OP_ALL_MATCH, (left, right, options, context) => {\n    if (!Array.isArray(left)) {\n        throw new Error(MSG.VALUE_NOT_ARRAY(ops.ALL_MATCH));\n    }\n\n    const errors = [];\n\n    left.every((leftItem) => {\n        const reason = validate(leftItem, right, { ...options, asPredicate: false }, context);\n        if (reason !== true) {\n            errors.push(MSG.validationErrors[ops.ALL_MATCH](context.name, left, right, context), ..._castArray(reason));\n\n            if (options.abortEarly) {\n                return false;\n            }\n        }\n\n        return true;\n    });\n\n    if (errors.length > 0) {\n        if (options.throwError) {\n            throw new ValidationError(errors, left, context.path);\n        }\n\n        if (!options.asPredicate) {\n            context.$$ERROR = errors.length === 1 && options.plainError ? errors[0] : errors;\n        }\n\n        return false;\n    }\n\n    return true;\n});\n\nconfig.addValidatorToMap(OP_ANY_ONE_MATCH, (left, right, options, context) => {\n    if (!Array.isArray(left)) {\n        throw new Error(MSG.VALUE_NOT_ARRAY(ops.ANY_ONE_MATCH));\n    }\n\n    let found = left.find((leftItem) => {\n        const reason = validate(leftItem, right, { ...options, abortEarly: false, throwError: false }, context);\n        return reason === true;\n    });\n\n    if (!found) {\n        context.$$ERROR = MSG.validationErrors[ops.ANY_ONE_MATCH](context.name, left, right, context);\n    }\n\n    return found ? true : false;\n});\n\nconfig.addValidatorToMap(OP_TYPE, (left, right, options, context) => {\n    let type;\n    let schema;\n\n    if (Array.isArray(right)) {\n        if (right.length === 0) {\n            throw new Error(MSG.INVALID_OP_EXPR(OP_TYPE[0], right));\n        }\n\n        type = right[0];\n        if (right.length > 1) {\n            schema = right[1];\n        }\n    } else if (typeof right === 'string') {\n        type = right;\n    } else if (typeof right === 'object') {\n        type = right.type;\n        schema = right.schema;\n    }\n\n    if (!Types.Builtin.has(type)) {\n        throw new Error(MSG.UNSUPPORTED_TYPE(type));\n    }\n\n    const reason = Types[type].validate(left, schema, options, context);\n    if (reason !== true) {\n        context.$$ERROR = reason;\n        return false;\n    }\n\n    return true;\n});\n\nconfig.addValidatorToMap(OP_HAS_KEYS, (left, right) => {\n    if (typeof left !== 'object') {\n        return false;\n    }\n\n    return Array.isArray(right) ? right.every((key) => _has(left, key)) : _has(left, right);\n});\n\nconfig.addValidatorToMap(OP_START_WITH, (left, right, options, context) => {\n    if (typeof left !== 'string') {\n        return false;\n    }\n\n    right = processRightValue(right, context);\n\n    if (typeof right !== 'string') {\n        throw new Error(MSG.OPERAND_NOT_STRING(ops.START_WITH));\n    }\n\n    return left.startsWith(right);\n});\n\nconfig.addValidatorToMap(OP_END_WITH, (left, right, options, context) => {\n    if (typeof left !== 'string') {\n        return false;\n    }\n\n    right = processRightValue(right, context);\n\n    if (typeof right !== 'string') {\n        throw new Error(MSG.OPERAND_NOT_STRING(ops.END_WITH));\n    }\n\n    return left.endsWith(right);\n});\n\nconfig.addValidatorToMap(OP_SAME_AS, (left, right, options, context) => {\n    if (typeof left === 'object') {\n        throw new Error(MSG.VALUE_NOT_PRIMITIVE(ops.OP_SAME_AS));\n    }\n    if (typeof right !== 'string') {\n        throw new Error(MSG.OPERAND_NOT_STRING(ops.OP_SAME_AS));\n    }\n\n    return left === context.$$PARENT[right];\n});\n\nexport default validate;\n"],"mappings":"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"}